<app-nav componentName="Justificativa para pausas de máquina"></app-nav>
<div class="container-fluid">
  <div class="row">
    <app-menu linkActive="machinepause"></app-menu>
    <main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4 margin-top-45">
      <nav>
        <div class="nav nav-tabs" id="nav-tab" role="tablist">
          <a class="nav-item nav-link active" id="nav-lancar-pausa-tab" data-toggle="tab" href="#nav-lancar-pausa" role="tab" aria-controls="nav-lancar-pausa" aria-selected="true">
            Lançar pausas</a>
          <a class="nav-item nav-link" id="nav-ver-pausas-tab" data-toggle="tab" href="#nav-ver-pausas" role="tab" aria-controls="nav-ver-pausas" aria-selected="false">
            Pausas lançadas
            <span class="badge badge-pill badge-secondary">{{pauses.length}}</span></a>
          <a class="nav-item nav-link disabled" id="nav-timer-tab" data-toggle="tab" href="#" role="tab" aria-controls="nav-timer" aria-selected="false">
            Próxima atualização: {{timerStr}}</a>  
        </div>
      </nav>
      <div class="tab-content" id="nav-tabContent">
        <div class="tab-pane fade show active" id="nav-lancar-pausa" role="tabpanel" aria-labelledby="nav-lancar-pausa-tab">
          <div class="row margin-bottom-5px margin-top-5px">        
            <div class="col-md-12 order-md-1">
              <input placeholder="Para ver as pausas, clique aqui e selecione uma data"
                    class="form-control form-control-no-border"
                    [(ngModel)]="date"
                    [owlDateTimeTrigger]="dt" 
                    [owlDateTime]="dt" 
                    (dateTimeChange)="changeDateRange($event)"
                    #dateValidation="ngModel" />
              <owl-date-time [pickerType]="'calendar'" #dt></owl-date-time>          
            </div>
          </div>
          <div class="table-responsive">        
            <ag-grid-angular #agGrid
              style="width: 100%; height: 400px"
              id="myGrid"
              class="ag-theme-balham"
              [columnDefs]="columnDefs"
              [enterMovesDownAfterEdit]="true"
              [enterMovesDown]="true"
              [animateRows]="true"
              [rowSelection]="rowSelection"
              [getRowHeight]="getRowHeight"
              (gridReady)="onGridReady($event)"
              enableColResize
              enableSorting
              enableFilter 
              (cellValueChanged)="onCellValueChanged($event)"
            ></ag-grid-angular>        

          </div>
          <div class="row">
            <div class="col-md-12">
              <strong>
                *Selecione uma data para exibir as pausas do dia. Para informar a justificativa, clique duas vezes sobre a coluna ou pressione F2.
                <br>As pausas são salvas automaticamente.
              </strong>
            </div>
          </div>        
        </div>
        <div class="tab-pane fade" id="nav-ver-pausas" role="tabpanel" aria-labelledby="nav-ver-pausas-tab">
          <div class="table-responsive margin-top-5px">
            <table class="table table-striped table-sm" *ngIf="pauses.length > 0">
              <thead>
                <tr>
                  <th>Máquina</th>
                  <th>Data</th>
                  <th>Pausa</th>
                  <th>Justificativa</th>
                  <th>Inserido em</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let pause of pauses">
                  <td>{{pause.mc_cd}}- {{pause.name}}</td>
                  <td>{{pause.date_ref}}</td>
                  <td>{{pause.pause}}</td>
                  <td>{{pause.justification}}</td>
                  <td>{{pause.inserted_at}}</td>         
                </tr>                
              </tbody>
            </table>
            <div class="alert alert-info margin-top-5px" role="alert" *ngIf="pauses.length == 0">
              Nenhuma pause informada até o momento.
            </div>  
          </div>
        </div>
      </div>      
    </main>
  </div>
</div>
